{"files":[{"id":"ed61db2c-85c6-434b-aac5-29a4e869f539","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/New_York\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"MYSELF\"\n  }\n}"},{"id":"cfc26d84-2b51-4088-81ff-a38b6164ef9a","name":"Код","type":"server_js","source":"function doGet(e) {\n  if(typeof e \u003d\u003d \u0027undefined\u0027)\n  {\n    Logger.log(\u0027undefined\u0027);\n  };\n // var openbase \u003d SpreadsheetApp.openById(\u00271wz9y9gUamh3rnuS0dCU2MyXyu_pyi4sqYnt_89MlwY0\u0027);\n // var opensheet \u003d openbase.getSheetByName(\u0027Applications\u0027);\n/*  var setData \u003d new Object();\n  let i \u003d 1;\n  setData[i] \u003d{ \n  ghbdtn:\"admlakdf\",*/\n // \"asfnsdlfn\": \"asdnasdljgnf\"\n // };\n // setData[2] \u003d {\u0027asdasd\u0027:34}\n // let first \u003d \"first\" + String(i);\n  //var str \u003d opensheet.getRange(\"B\" + 2).getValue();\n // setData.(first + 1) \u003d 2;  \n //setData[i].init \u003d opensheet.getRange(\"B\" + 2).getValue();\n //setOrd \u003d getOrders(\u0027shizza.dml@gmail.com\u0027);\n  var orders \u003d getOrders(\u0027zaguzova.elise@gmail.com\u0027);\n  var jsonorders \u003d JSON.stringify(orders);\n  Logger.log(jsonorders);\n  Logger.log(orders);\n  Logger.log(JSON.parse(jsonorders));\n\n\n  htmlOutput \u003d HtmlService.createTemplateFromFile(\u0027Без названия\u0027);\n  return htmlOutput.evaluate();\n\n}\n\nfunction getOrders(email)\n{\n  var openbase \u003d SpreadsheetApp.openById(\u00271wz9y9gUamh3rnuS0dCU2MyXyu_pyi4sqYnt_89MlwY0\u0027);\n  var opensheet \u003d openbase.getSheetByName(\u0027Applications\u0027);\n  var setData \u003d new Object();\n  var sum \u003d 0;\n\n  for (i \u003d 2; i \u003c\u003d opensheet.getLastRow(); i++)\n  {\n    var str \u003d opensheet.getRange(\"B\" + i).getValue();\n    if (str \u003d\u003d email)\n    {\n      sum++;\n      setData[sum] \u003d {\n      \u0027primarykey\u0027 : sum,\n      \u0027orderName\u0027 : opensheet.getRange(\"C\"+i).getValue(),\n      \u0027description\u0027 : opensheet.getRange(\"D\"+i).getValue(),\n      \u0027orderStatus\u0027 : opensheet.getRange(\"E\"+i).getValue(),\n      \u0027executer\u0027 : opensheet.getRange(\"F\"+i).getValue(),\n      \u0027createDate\u0027 : opensheet.getRange(\"G\"+i).getValue(),\n      \u0027processDate\u0027 : opensheet.getRange(\"H\"+i).getValue(),\n      \u0027endingDate\u0027 : opensheet.getRange(\"I\"+i).getValue()\n      };\n      setData[\"sumorders\"] \u003d sum;\n    };\n\n    \n  }\n\n  return setData;\n}"},{"id":"50209936-f880-40d2-a9f2-194ce3a49038","name":"Без названия","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e-\n    \u003cstyle type \u003d \"text/css\"\u003e\n    td{\n      text-align: center;\n    }\n    \u003c/style\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003c? var email \u003d Session.getActiveUser().getEmail();\n    var orders \u003d getOrders(email); ?\u003e\n   \u003ch1\u003e \u003c?\u003d  orders[1].orderName ?\u003e \u003c/h1\u003e\n   \u003cform\u003e\n   \u003ctable align \u003d \"center\"\u003e\n     \u003ctr\u003e\n       \u003cth\u003e№\u003c/th\u003e\n       \u003cth\u003eOrder name\u003c/th\u003e\n       \u003cth\u003eDescription\u003c/th\u003e\n       \u003cth\u003eStatus\u003c/th\u003e\n       \u003cth\u003eExecuter\u003c/th\u003e\n       \u003cth\u003eDate of creation\u003c/th\u003e\n       \u003cth\u003eDate of processing\u003c/th\u003e\n       \u003cth\u003eDate of ending\u003c/th\u003e\n     \u003c/tr\u003e\n     \u003c? for(i \u003d 1; i \u003c\u003d orders.sumorders; i++) { ?\u003e\n     \u003ctr\u003e\n       \u003ctd\u003e\u003c?\u003d i ?\u003e\u003c/td\u003e\n       \u003ctd\u003e\u003c?\u003d orders[i].orderName ?\u003e\u003c/td\u003e\n       \u003ctd\u003e\u003c?\u003d orders[i].description ?\u003e\u003c/td\u003e\n       \u003ctd\u003e\u003c?\u003d orders[i].orderStatus ?\u003e\u003c/td\u003e\n       \u003ctd\u003e\u003c?\u003d orders[i].executer ?\u003e\u003c/td\u003e\n       \u003ctd\u003e\u003c?\u003d orders[i].createDate ?\u003e\u003c/td\u003e\n       \u003ctd\u003e\u003c?\u003d orders[i].processDate ?\u003e\u003c/td\u003e\n       \u003ctd text-align\u003d\"left\"\u003e\u003c?\u003d orders[i].endingDate ?\u003e\u003c/td\u003e\n     \u003c/tr\u003e  \n     \u003c? } ?\u003e\n   \u003c/table\u003e\n   \u003cinput type\u003d\"submit\" name\u003d\"Sub\"\u003e\n   \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n"}]}