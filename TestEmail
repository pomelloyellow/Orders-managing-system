{"files":[{"id":"53e0d479-e9bf-4171-8686-9e9d8dbd5342","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/New_York\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE\"\n  }\n}"},{"id":"a4692f34-2e78-43af-89b3-9937de068c88","name":"Client","type":"server_js","source":"\nfunction doGet(e) {\n  if(!e.parameter.pageApp)\n  {\n    var htmlOutput \u003d HtmlService.createTemplateFromFile(\u0027UserApplicationForm\u0027);\n    htmlOutput.url \u003d getURL();\n    return htmlOutput.evaluate();\n  }\n  else if(e.parameter[\u0027pageApp\u0027])\n  {\n    Logger.log(JSON.stringify(e.parameter[\u0027pageApp\u0027]));\n    var htmlOutput1 \u003d HtmlService.createTemplateFromFile(\u0027GetApplicationForm\u0027);\n    return htmlOutput1.evaluate();\n  }\n\n}\n\nfunction getURL()\n{\n  var url \u003d ScriptApp.getService().getUrl();\n  return url;\n}\n\n/*\n    var emailUser \u003d Session.getActiveUser().getEmail();\n    var regDate \u003d Utilities.formatDate(new Date(), \"GMT\", \"yyyy-MM-dd\u0027T\u0027HH:mm:ss\u0027Z\u0027\");\n\n    var formData \u003d {\n    \u0027emailUser\u0027: emailUser,\n    \u0027regDate\u0027 : regDate\n    };\n    \n    var options \u003d {\n    \u0027method\u0027 : \u0027post\u0027,\n    \u0027payload\u0027 : formData\n    };\n\n    var urlServer \u003d \"https://script.google.com/macros/s/AKfycbyHKNAYu5hx5TcrTeq9dx5E_r7qgFHBWqNREXwsG07v63fPkZZAjydMsPT0b0GhGEGy/exec\";\n\n    res \u003d UrlFetchApp.fetch(urlServer, options);\n    responseCode \u003d res.getResponseCode(); \n    contentText \u003d res.getContentText();\n    Logger.log(contentText);\n */\n\n\n    /*if (contentText \u003d\u003d 0)\n    {                         //Если 0, то откроем форму, где пользователь укажет имя и фамилию\n    var formData \u003d {\n    \u0027emailuser\u0027: emailUser,\n    \u0027regDate\u0027 :  Utilities.formatDate(new Date(), \"GMT\", \"yyyy-MM-dd\u0027T\u0027HH:mm:ss\u0027Z\u0027\")\n    };\n    res1 \u003d UrlFetchApp.fetch(urlServer, options);\n    responseCode \u003d res1.getResponseCode(); \n    contentText1 \u003d res1.getContentText(); //Вернет 0 или email\n    Logger.log(contentText1);\n    var htmlOutput \u003d HtmlService.createTemplateFromFile(\u0027ApplicationForm\u0027);\n    return htmlOutput.evaluate();\n    }\n    else if (contentText \u003d\u003d emailUser) //Если email, то откроем Пользовательскую форму\n    var htmlOutput \u003d HtmlService.createTemplateFromFile(\u0027ApplicationForm\u0027);\n    return htmlOutput.evaluate();*/\n\n      /*res \u003d UrlFetchApp.fetch(urlServer, options);\n    responseCode \u003d res.getResponseCode(); \n    contentText \u003d res.getContentText(); //Вернет 0 или email\n    Logger.log(contentText);*/\n\n  /*else if (e.parameter.lastName \u0026\u0026 e.parameter.firstName)\n    {\n\n    var newUserData \u003d {\n      \u0027firstname\u0027: e.parameter.firstName,\n      \u0027lastname\u0027 : e.parameter.lastName,\n      \u0027emailuser\u0027: Session.getActiveUser().getEmail()\n    };\n\n    var url \u003d \"https://script.google.com/macros/s/AKfycbzuZ8OwQwWUfxuBSfwZytMnzjAfkhipcfIT7VuaP-ufa4LAHj16CStrCAY0HiOkw42X/exec\";\n    var opti \u003d {\n      \u0027method\u0027 : \u0027post\u0027,\n      \u0027payload\u0027: newUserData\n    };\n\n    UrlFetchApp.fetch(url, opti);\n\n    var htmlOutput \u003d HtmlService.createTemplateFromFile(\u0027ApplicationForm\u0027);\n    return htmlOutput.evaluate();\n    }*/\n//\u003c?var url \u003d getUrl(); ?\u003e \u003cinput type \u003d \"hidden\" value \u003d \"\u003c?\u003d url ?\u003e\" id \u003d \"url\"\u003e\n\n/*function doGet(e) {\n  if(e.parameter[\u0027page\u0027] \u003d\u003d \u0027PageApp\u0027){\n  var ss \u003d SpreadsheetApp.openByUrl(\u0027https://docs.google.com/spreadsheets/d/1wz9y9gUamh3rnuS0dCU2MyXyu_pyi4sqYnt_89MlwY0/edit#gid\u003d0\u0027);\n  var r \u003d ss.getLastRow() + 1;\n  var rr \u003d ss.getActiveSheet().getRange(\"A\"+r).setValue(e);\n  }\n}\n\nfunction getUrl()\n{\n  var url \u003d ScriptApp.getService().getUrl();\n  return url;\n}*/\n\n\n/*function getEmail() {\n  return Session.getActiveUser().getEmail();\n}\n\nfunction funcem()\n{\n  Logger.log(getEmail())\n}\n\nfunction emailsheet()\n{\n  var ss \u003d SpreadsheetApp.openByUrl(\u0027https://docs.google.com/spreadsheets/d/1cTQL7Pj94gcNfnveTXCmeKzmKGNvxCVQ5htmXYdaVPI/edit#gid\u003d1245956701\u0027);\n  var r \u003d ss.getLastRow();\n  var rr \u003d ss.getActiveSheet().getRange(\"A\"+(r+1)).setValue(getEmail());\n  var formattedDate \u003d Utilities.formatDate(new Date(), \"GMT\", \"yyyy-MM-dd\u0027T\u0027HH:mm:ss\u0027Z\u0027\");\n  var rr1 \u003d ss.getActiveSheet().getRange(\"B\"+(r+1)).setValue(formattedDate);\n}\n\n    function getEmail(){\n  var e \u003d document.getElementById(\"emailuser\");\n  e.innerHTML\u003d\u0027Found you\u0027;\n}\n */\n"},{"id":"cab370ea-71f8-4d60-9065-1309a70749b2","name":"UserApplicationForm","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003ch1\u003eAppForm\u003c/h1\u003e\n    \u003cform action \u003d \"\u003c?\u003d url ?\u003e\" method \u003d \"GET\" \u003e\n    \u003cinpyt type \u003d \"hidden\" name \u003d \"pageApp\" value \u003d \"getAppForm\" \u003e\n    \u003cinput type \u003d \"submit\" name \u003d \"sub\" value \u003d \"1\"\u003e\n    \u003c/form\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n"},{"id":"711f104c-5b84-4c43-b782-4b7d5c5a5c66","name":"GetApplicationForm","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \n  \u003c/body\u003e\n\u003c/html\u003e\n"}]}